diff -Nur olsrd-0.4.10.orig/src/cfgparser/oparse.c olsrd-0.4.10/src/cfgparser/oparse.c
--- olsrd-0.4.10.orig/src/cfgparser/oparse.c	2006-01-01 17:15:57.000000000 +0100
+++ olsrd-0.4.10/src/cfgparser/oparse.c	2006-12-01 08:21:39.000000000 +0100
@@ -1921,6 +1921,7 @@
       return -1;
     }
   h->netmask.v4 = in.s_addr;
+  h->net.v4 &= h->netmask.v4;
   /* Queue */
   h->next = cnf->hna4_entries;
   cnf->hna4_entries = h;
diff -Nur olsrd-0.4.10.orig/src/cfgparser/oparse.y olsrd-0.4.10/src/cfgparser/oparse.y
--- olsrd-0.4.10.orig/src/cfgparser/oparse.y	2005-11-17 05:25:44.000000000 +0100
+++ olsrd-0.4.10/src/cfgparser/oparse.y	2006-12-01 08:23:05.000000000 +0100
@@ -701,6 +701,7 @@
       return -1;
     }
   h->netmask.v4 = in.s_addr;
+  h->net.v4 &= h->netmask.v4;
   /* Queue */
   h->next = cnf->hna4_entries;
   cnf->hna4_entries = h;
